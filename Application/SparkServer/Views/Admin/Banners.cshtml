@model SparkServer.ViewModels.BlogEditViewModel

@{
    Layout = "~/Views/Shared/_AdminLayout.cshtml";
    ViewBag.Title = "Banners";
}

<h1>@ViewBag.Title</h1>

@using (Html.BeginForm(actionName: "BlogUpdate", controllerName: "Admin", method: FormMethod.Post))
{
    <div class="row">

    </div>
}

<div class="row">

    <table id="BannerTable">
        <thead>
            <th>Image</th>
            <th>Path</th>
        </thead>
        <tbody>
            
        </tbody>
    </table>

</div>

<script type="text/template" id="BannerTableRow">
    <tr>
        <td><img src="##IMAGE_THUMBNAIL_SRC##" alt="Image Preview" /></td>
        <td>##IMAGE_PATH##</td>
    </tr>
</script>

@section PageScripts {
    
    <script>

        $(function () {
    
            $.ajax({

                url: "/Admin/AjaxBannerList",
                type: "GET",
                data: {}

            }).done(function (response) {

                if (response.Status == "OK") {

                    var newHTML = buildRows(response.Data);

                    $("#BannerTable > tbody").html(newHTML);

                } else {

                    alert("Error:\n\n" + response.Message);

                }
            });

            var buildRows = function (responseData) {

                var tableOutput = "";
                var rowData = responseData;

                for (row in rowData) {

                    var output = $("#BannerTableRow").html();
                    output = output.replace("##IMAGE_THUMBNAIL_SRC##", rowData[row].ThumbnailPath);
                    output = output.replace("##IMAGE_PATH##", rowData[row].Filepath);
                    tableOutput += output;

                }

                return tableOutput;
            }

        });

    </script>
    
}